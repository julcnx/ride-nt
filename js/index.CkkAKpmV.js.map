{"version":3,"file":"index.CkkAKpmV.js","sources":["../../app/js/config.js","../../app/js/auth.js","../../app/js/layers.js","../../app/js/transparency.js","../../app/js/mapSetup.js","../../app/js/legend.js","../../app/js/contextMenu.js","../../app/js/gpxDragDrop.js","../../app/js/keyboard.js","../../app/js/draw.js","../../app/js/search.js","../../app/js/index.js"],"sourcesContent":["// Auto-generated config file\nexport const isDev = location.protocol.startsWith('file');\n\nexport const clipBounds = {\n  \"minLat\": 16.5,\n  \"maxLat\": 20.5,\n  \"minLon\": 97.5,\n  \"maxLon\": 103\n};\n\nexport const regionBounds = [\n  [clipBounds.minLat, clipBounds.minLon],\n  [clipBounds.maxLat, clipBounds.maxLon]\n];\n\nexport const colors = {\n  \"fast\": \"rgba(0, 140, 60, 1)\",\n  \"moderate\": \"rgba(255, 179, 0, 1)\",\n  \"slow\": \"rgba(255, 40, 40, 1)\",\n  \"veryTechnical\": \"rgba(128, 0, 128, 1)\",\n  \"paved\": \"rgba(61, 96, 203, 1)\",\n  \"residential\": \"rgba(160, 140, 120, 0.5)\",\n  \"maybe\": \"rgba(180, 180, 180, 1)\",\n  \"likely\": \"rgba(100, 100, 100, 1)\"\n};\n\nexport const speeds = [\n  {\n    \"max\": 7,\n    \"color\": \"rgba(128, 0, 128, 1)\"\n  },\n  {\n    \"max\": 15,\n    \"color\": \"rgba(255, 40, 40, 1)\"\n  },\n  {\n    \"max\": 30,\n    \"color\": \"rgba(255, 179, 0, 1)\"\n  },\n  {\n    \"max\": null,\n    \"color\": \"rgba(0, 140, 60, 1)\"\n  }\n];\n\nexport const timestamp = 1753629478723;\n\nexport const minZoom = 9;\nexport const maxZoom = 13;\n  ","const PASSWORD = 'UmlkZVNhZmUyMDI1IQ==';\nconst STORAGE_KEY_AUTH = 'rident_auth';\nconst ONE_MONTH_MS = 30 * 24 * 60 * 60 * 1000;\n\nexport function isPasswordValid() {\n  const stored = localStorage.getItem(STORAGE_KEY_AUTH);\n  if (!stored) return false;\n  try {\n    const { password, expires } = JSON.parse(stored);\n    return password === PASSWORD && Date.now() < expires;\n  } catch {\n    return false;\n  }\n}\n\nexport function storePassword() {\n  const expires = Date.now() + ONE_MONTH_MS;\n  localStorage.setItem(STORAGE_KEY_AUTH, JSON.stringify({ password: PASSWORD, expires }));\n}\n\nexport function promptPassword() {\n  if (!isPasswordValid()) {\n    const input = prompt('Enter password to view the map:');\n    if (input !== atob(PASSWORD)) {\n      alert('Incorrect password. Access denied.');\n      document.body.innerHTML = \"<h2 style='text-align:center;margin-top:20%'>Access Denied</h2>\";\n      // document.body.classList.remove('locked');\n      // throw new Error('Unauthorized');\n    } else {\n      storePassword();\n      // document.body.classList.remove('locked');\n    }\n  }\n  document.body.classList.remove('locked');\n}\n","import { isDev, timestamp, minZoom, maxZoom } from './config.js';\n\nexport const mainOverlay = L.tileLayer(\n  isDev\n    ? `../../tiles/heatmap/ride/{z}/{x}/{y}.png?ts=${timestamp}`\n    : `https://julcnx.github.io/tiles/heatmap/ride/{z}/{x}/{y}.png?ts=${timestamp}`,\n  {\n    tileSize: 256,\n    minNativeZoom: minZoom,\n    maxNativeZoom: maxZoom,\n    zIndex: 10,\n    attribution: isDev ? `Ride NT (Dev)` : 'Ride NT',\n    id: 'ride-nt',\n  }\n);\n\nexport const mainOverlayAlt = L.tileLayer(\n  `https://julcnx.github.io/tiles/heatmap/ride/{z}/{x}/{y}.png?ts=${timestamp}`,\n  {\n    tileSize: 256,\n    minNativeZoom: minZoom,\n    maxNativeZoom: maxZoom,\n    zIndex: 10,\n    attribution: `Ride NT`,\n    id: 'ride-nt-alt',\n  }\n);\n\nfunction createDRRLayer(attribution, layers) {\n  return L.tileLayer.wms(\n    'https://gisportal.drr.go.th/portal/sharing/servers/aa5fdea8d96542d49d3d8731d77458b7/rest/services/GISBaseMaps/DRR_Dynamic/MapServer/export',\n    {\n      transparent: true,\n      attribution,\n      format: 'png',\n      layers,\n      bboxSR: 102100,\n      f: 'image',\n      className: 'overlay',\n    }\n  );\n}\n\nconst DRR_DYNAMIC_LAYERS = {\n  all: createDRRLayer('DRR (All)', 'show:1,2,3,4,5,6,7'),\n  highways: createDRRLayer('DRR (Highways)', 'show:-1,-1,-1,3'),\n  majorHighways: createDRRLayer('DRR (Highways Major)', 'show:-1,-1,-1,2'),\n  ruralRoads: createDRRLayer('DRR (Rural Roads)', 'show:-1,-1,-1,7'),\n};\n\nconst GOOGLE_LAYERS = { satellite: 's', terrain: 'p', hybrid: 'h', maps: 'm' };\n\nconst googleSatellite = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.satellite}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    attribution: `Google Satellite`,\n    id: 'google-satellite',\n  }\n);\n\nconst googleMaps = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.maps}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    attribution: `Google Maps`,\n    id: 'google-maps',\n  }\n);\n\nconst googleTerrain = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.terrain}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    attribution: `Google Terrain`,\n    id: 'google-terrain',\n  }\n);\n\nconst googleHybrid = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.hybrid}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    transparent: true,\n    zIndex: 2,\n    attribution: `Google Hybrid`,\n    id: 'google-hybrid',\n  }\n);\n\nconst esriFirefly = L.esri.basemapLayer('ImageryFirefly', {\n  maxNativeZoom: 18,\n  attribution: `ESRI Firefly`,\n  id: 'esri-firefly',\n});\n\nconst esriClarity = L.esri.basemapLayer('ImageryClarity', {\n  maxNativeZoom: 17,\n  attribution: `ESRI Clarity`,\n  id: 'esri-clarity',\n});\n\nconst esriWayback = L.tileLayer(\n  'https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/WMTS/1.0.0/default028mm/MapServer/tile/10/{z}/{y}/{x}',\n  {\n    maxNativeZoom: 17,\n    attribution: `ESRI Wayback`,\n    id: 'esri-wayback',\n  }\n);\n\nconst thunderforestTransport = L.tileLayer(\n  'https://{s}.tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=6e5478c8a4f54c779f85573c0e399391',\n  {\n    attribution: `Thunderforest Transport`,\n    maxNativeZoom: 18,\n    subdomains: 'abc',\n  }\n);\n\nconst thunderforestCycle = L.tileLayer(\n  'https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=6e5478c8a4f54c779f85573c0e399391',\n  {\n    attribution: `Thunderforest Transport`,\n    maxNativeZoom: 18,\n    subdomains: 'abc',\n    id: 'thunderforest-cyclemap',\n  }\n);\n\nconst osmStandard = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n  subdomains: ['a', 'b', 'c'],\n  attribution: `OSM Contributors`,\n  id: 'openstreetmap',\n});\n\nconst worldTopoMap = L.tileLayer(\n  'https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',\n  {\n    attribution: `WorldTopoMap`,\n    maxNativeZoom: 18,\n    id: 'worldtopomap',\n  }\n);\n\nconst rtsMap = L.tileLayer(`../../tiles/50k/{z}/{x}/{y}.png`, {\n  attribution: `50K`,\n  minNativeZoom: 13,\n  maxNativeZoom: 14,\n  id: '50k',\n});\n\nconst slopeTiles = L.tileLayer(`../../tiles/slope/{z}/{x}/{y}.png`, {\n  attribution: `Slope`,\n  minNativeZoom: 11,\n  maxNativeZoom: 11,\n  opacity: 0.30,\n  id: 'slope',\n});\n\nconst googleStreetViewTiles = L.tileLayer(\n  'https://mts{s}.googleapis.com/vt?hl=en-US&lyrs=svv|cb_client:apiv3&style=40,18&x={x}&y={y}&z={z}',\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 13,\n    maxZoom: 20,\n    // opacity: 0.7,\n    zIndex: 1,\n    className: 'overlay',\n    attribution: `Google Street View`,\n  }\n);\n\nconst mapillaryVector = L.vectorGrid.protobuf(\n  'https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token=MLY|4100327730013843|5bb78b81720791946a9a7b956c57b7cf',\n  {\n    transparent: true,\n    maxNativeZoom: 13,\n    zIndex: 1,\n    className: 'overlay',\n    attribution: `Mapillary`,\n    vectorTileLayerStyles: {\n      sequence: () => ({\n        color: 'rgb(20, 150, 60)',\n        weight: 10,\n        // opacity: 0.7,\n      }),\n    },\n  }\n);\n\nconst kartaViewTiles = L.tileLayer(\n  'https://karta-gateway.geo.azure.myteksi.net/view/api/2.0/sequence/tiles/{x}/{y}/{z}.png',\n  {\n    transparent: true,\n    minNativeZoom: 13,\n    maxNativeZoom: 20,\n    className: 'overlay',\n    attribution: `KartaView`,\n  }\n);\n\nexport const stravaHeatmap = L.tileLayer(\n  'https://content-{s}.strava.com/identified/globalheat/all/hot/{z}/{x}/{y}.png?v=19',\n  {\n    subdomains: ['a'],\n    minNativeZoom: 11,\n    maxNativeZoom: 13,\n    zIndex: 2,\n    className: 'overlay',\n    attribution: `Strava Heatmap All`,\n  }\n);\n\nconst osmGpsTraces = L.tileLayer(\n  `https://{s}.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png?ts=${timestamp}`,\n  {\n    transparent: true,\n    maxNativeZoom: 14,\n    zIndex: 9,\n    className: 'overlay',\n    attribution: `OSM GPS Traces`,\n  }\n);\n\nexport const baseLayers = {\n  'World Topo Map': worldTopoMap,\n  'OSM Standard': osmStandard,\n  'Google Maps': googleMaps,\n  'Google Terrain': googleTerrain,\n  'Transport Map': thunderforestTransport,\n  'Cycle Map': thunderforestCycle,\n};\n\nif (isDev) {\n  baseLayers['RTS Map'] = rtsMap;\n}\n\nexport const satelliteLayers = {\n  'Google Satellite': googleSatellite,\n  'ESRI Firefly': esriFirefly,\n  'ESRI Clarity': esriClarity,\n  'ESRI Wayback': esriWayback,\n};\n\nexport const overlays = {\n  'OpenStreetMap traces': osmGpsTraces,\n};\n\n// Add additional layers for development mode\n// These layers are not included in production to keep the map clean and focused on essential data.\n// They are useful for testing and development purposes, providing additional context or data layers.\nif (isDev) {\n  overlays['Google Street View'] = googleStreetViewTiles;\n  overlays['Google Hybrid'] = googleHybrid;\n  overlays.Mapillary = mapillaryVector;\n  overlays.KartaView = kartaViewTiles;\n  overlays['Strava Heatmap'] = stravaHeatmap;\n  overlays['DRR (All)'] = DRR_DYNAMIC_LAYERS.all;\n  overlays['Slope'] = slopeTiles;\n}\n","import { mainOverlay, overlays, satelliteLayers } from './layers.js';\n\nexport let baseLayerTransparency = 0;\n\nexport function addBaseLayerTransparencyControl(map) {\n  const baseControl = L.control({ position: 'topleft' }); // Or 'topleft' if needed\n\n  baseControl.onAdd = function () {\n    const div = L.DomUtil.create(\n      'div',\n      'leaflet-control leaflet-top-center leaflet-control-layers leaflet-control-layers-expanded transparency-toolbar'\n    );\n\n    // --- Dropdown ---\n    const select = L.DomUtil.create('select', '', div);\n    select.className = 'transparency-select';\n\n    Object.keys(satelliteLayers).forEach(label => {\n      const option = document.createElement('option');\n      option.value = label;\n      option.textContent = label;\n      select.appendChild(option);\n    });\n\n    const savedName = localStorage.getItem('rident_satellite');\n    const defaultName =\n      savedName && satelliteLayers[savedName] ? savedName : Object.keys(satelliteLayers)[0];\n\n    select.value = defaultName;\n\n    let currentSatelliteLayer = satelliteLayers[defaultName];\n    currentSatelliteLayer.addTo(map);\n    currentSatelliteLayer.setOpacity(baseLayerTransparency / 100);\n    currentSatelliteLayer.setZIndex(1);\n\n    // --- Slider ---\n    const input = L.DomUtil.create('input', '', div);\n    input.className = 'transparency-slider';\n    input.type = 'range';\n    input.min = 0;\n    input.max = 100;\n    input.step = 1;\n    input.value = baseLayerTransparency;\n\n    // --- Handlers ---\n    L.DomEvent.on(input, 'input', e => {\n      const value = parseFloat(e.target.value);\n      baseLayerTransparency = value;\n\n      const effectiveOpacity = (100 - value) / 100;\n\n      // const overlayPane = document.querySelector(\n      //   \".leaflet-pane.leaflet-overlay-pane\"\n      // );\n      // overlayPane.style.opacity = effectiveOpacity;\n\n      // mainOverlay.setOpacity(effectiveOpacity);\n\n      // Update all overlays\n      // Object.values(overlays).forEach((layer) => {\n      //   if (typeof layer.setOpacity === \"function\") {\n      //     layer.setOpacity(effectiveOpacity);\n      //   }\n      // });\n\n      if (currentSatelliteLayer) {\n        currentSatelliteLayer.setOpacity(baseLayerTransparency / 100);\n      }\n\n      input.blur(); // Remove focus to prevent slider from sticking\n    });\n\n    L.DomEvent.on(select, 'change', e => {\n      const selectedName = e.target.value;\n      if (map.hasLayer(currentSatelliteLayer)) {\n        map.removeLayer(currentSatelliteLayer);\n      }\n      currentSatelliteLayer = satelliteLayers[selectedName];\n      currentSatelliteLayer.addTo(map);\n      currentSatelliteLayer.setOpacity(baseLayerTransparency / 100);\n      currentSatelliteLayer.setZIndex(1);\n      localStorage.setItem('rident_satellite', selectedName);\n    });\n\n    L.DomEvent.disableClickPropagation(div);\n\n    select.blur();\n    return div;\n  };\n\n  baseControl.addTo(map);\n}\n","import { regionBounds } from './config.js';\nimport { mainOverlay, mainOverlayAlt, baseLayers, satelliteLayers, overlays } from './layers.js';\nimport { baseLayerTransparency } from './transparency.js';\n\nconst STORAGE_KEY_VIEW = 'rident_map_view';\nconst STORAGE_KEY_BASE = 'rident_base_layer';\nconst STORAGE_KEY_SATELLITE = 'rident_satellite';\nconst STORAGE_KEY_OVERLAYS = 'rident_overlays';\n\nexport function initializeMap() {\n  document.getElementById('map').style.display = 'block';\n\n  const map = createMap();\n  setInitialView(map);\n\n  const layersControl = L.control\n    .layers(baseLayers, overlays, {\n      collapsed: true,\n      autoZIndex: false,\n      position: 'topright',\n    })\n    .addTo(map);\n\n  restoreLayerSelection(map);\n  setupEventListeners(map);\n\n  return {\n    map,\n    layersControl,\n  };\n}\n\nfunction createMap() {\n  const map = L.map('map', {\n    minZoom: 9,\n    maxBounds: L.latLngBounds(regionBounds).pad(0.3),\n    layers: [mainOverlay],\n    zoomControl: true,\n    maxZoom: 18,\n    attributionControl: true,\n  });\n  map.attributionControl.setPrefix('');\n\n  return map;\n}\n\nfunction setInitialView(map) {\n  const hashMatch = location.hash.match(/^#(\\d+)\\/([-\\d.]+)\\/([-\\d.]+)$/);\n  if (hashMatch) {\n    const zoom = +hashMatch[1];\n    const lat = +hashMatch[2];\n    const lng = +hashMatch[3];\n    map.setView([lat, lng], zoom);\n    return;\n  }\n\n  const saved = localStorage.getItem(STORAGE_KEY_VIEW);\n  if (saved) {\n    try {\n      const { center, zoom } = JSON.parse(saved);\n      map.setView(center, zoom);\n      return;\n    } catch {}\n  }\n\n  map.setView([18.79, 98.98], 10);\n}\n\nfunction restoreLayerSelection(map) {\n  let currentBaseLayer;\n\n  // Restore or fallback base layer\n  const baseName = localStorage.getItem(STORAGE_KEY_BASE);\n  if (baseName && baseLayers[baseName]) {\n    baseLayers[baseName].addTo(map);\n    currentBaseLayer = baseLayers[baseName];\n  } else {\n    baseLayers['World Topo Map'].addTo(map);\n    currentBaseLayer = baseLayers['World Topo Map'];\n  }\n\n  // Restore overlays\n  const overlayJSON = localStorage.getItem(STORAGE_KEY_OVERLAYS);\n  let savedOverlays = [];\n  try {\n    savedOverlays = overlayJSON ? JSON.parse(overlayJSON) : [];\n  } catch {}\n\n  if (savedOverlays.length) {\n    for (const [name, layer] of Object.entries(overlays)) {\n      if (savedOverlays.includes(name)) {\n        layer.addTo(map);\n      }\n    }\n  }\n\n  // Restore or default satellite layer\n  const satName = localStorage.getItem(STORAGE_KEY_SATELLITE);\n  let currentSatelliteLayer;\n  if (satName && satelliteLayers[satName]) {\n    currentSatelliteLayer = satelliteLayers[satName];\n  } else {\n    currentSatelliteLayer = satelliteLayers['Google Satellite'];\n  }\n\n  if (currentSatelliteLayer) {\n    currentSatelliteLayer.setOpacity(baseLayerTransparency / 100.0);\n    currentSatelliteLayer.addTo(map);\n  }\n\n  return { currentBaseLayer, currentSatelliteLayer };\n}\n\nfunction setupEventListeners(map) {\n  map.on('baselayerchange', e => {\n    const selectedBaseLayer = Object.entries(baseLayers).find(([_, v]) => v === e.layer);\n    if (selectedBaseLayer) {\n      localStorage.setItem(STORAGE_KEY_BASE, selectedBaseLayer[0]);\n      selectedBaseLayer[1].setZIndex(0);\n    }\n\n    const selectedSatLayer = Object.entries(satelliteLayers).find(([_, v]) => v === e.layer);\n    if (selectedSatLayer) {\n      localStorage.setItem(STORAGE_KEY_SATELLITE, selectedSatLayer[0]);\n      selectedSatLayer[1].setZIndex(1);\n      selectedSatLayer[1].setOpacity(baseLayerTransparency / 100);\n    }\n  });\n\n  map.on('overlayadd overlayremove', () => {\n    const activeOverlays = Object.entries(overlays)\n      .filter(([_, layer]) => map.hasLayer(layer))\n      .map(([name]) => name);\n    localStorage.setItem(STORAGE_KEY_OVERLAYS, JSON.stringify(activeOverlays));\n  });\n\n  map.on('moveend zoomend', () => {\n    const center = map.getCenter();\n    const zoom = map.getZoom();\n    const hash = `#${zoom}/${center.lat.toFixed(6)}/${center.lng.toFixed(6)}`;\n    location.hash = hash;\n    localStorage.setItem(STORAGE_KEY_VIEW, JSON.stringify({ center, zoom }));\n  });\n}\n","import { colors } from './config.js';\n\nexport function addLegend(map) {\n  const legend = L.control({ position: 'bottomright' });\n\n  legend.onAdd = function () {\n    const container = L.DomUtil.create('div', 'info legend');\n    container.style.position = 'relative';\n    container.style.transition = 'all 0.3s ease';\n    container.style.fontSize = '14px';\n    container.style.color = '#333';\n    container.style.maxWidth = '250px';\n\n    const opacity = 1;\n    const storageKey = 'rideNT-legend-visible';\n    let isVisible = false;\n\n    function colorBox(color) {\n      return `<span style=\"\n\t\t\t\tdisplay:inline-block;\n\t\t\t\twidth:14px;\n\t\t\t\theight:10px;\n\t\t\t\tmargin-right:8px;\n\t\t\t\tbackground-color:${color};\n\t\t\t\tvertical-align:middle;\n\t\t\t\"></span>`;\n    }\n\n    // --- Full panel content\n    const panel = document.createElement('div');\n    panel.style.background = 'rgba(255, 255, 255, 0.95)';\n    panel.style.borderRadius = '6px';\n    panel.style.padding = '8px';\n    panel.style.boxShadow = '0 2px 6px rgba(0,0,0,0.2)';\n    panel.style.display = 'none';\n    panel.style.flexDirection = 'column';\n\n    const header = document.createElement('div');\n    header.style.display = 'flex';\n    header.style.justifyContent = 'space-between';\n    header.style.alignItems = 'center';\n    header.style.marginBottom = '6px';\n\n    const title = document.createElement('span');\n    title.textContent = 'RideNT Legend';\n    title.style.fontWeight = 'bold';\n\n    const collapseBtn = document.createElement('a');\n    collapseBtn.href = '#';\n    collapseBtn.innerHTML = 'ðŸ”½';\n    collapseBtn.title = 'Collapse legend';\n    collapseBtn.style.fontSize = '18px';\n    collapseBtn.style.textDecoration = 'none';\n    collapseBtn.style.cursor = 'pointer';\n    collapseBtn.style.padding = '4px';\n\n    collapseBtn.onclick = e => {\n      e.preventDefault();\n      isVisible = false;\n      updateVisibility();\n    };\n\n    header.appendChild(title);\n    header.appendChild(collapseBtn);\n\n    const content = document.createElement('div');\n    content.innerHTML = `\n\t\t\t${colorBox(colors.paved)} Paved<br>\n\t\t\t${colorBox(colors.fast)} Fast dirt<br>\n\t\t\t${colorBox(colors.moderate)} Moderate dirt<br>\n\t\t\t${colorBox(colors.slow)} Slow / Technical<br>\n\t\t\t${colorBox(colors.veryTechnical)} Very technical<br>\n\t\t\t${colorBox(colors.likely)} Rural roads<br>\n\t\t\t${colorBox(colors.maybe)} Uncertain trails<br>\n\t\t\t<br>\n\t\t\t<span class=\"caption\">Speeds are approximate, based on dry GPX tracks with climate & rider factors considered. Accuracy not guaranteed.</span>\n\t\t`;\n\n    panel.appendChild(header);\n    panel.appendChild(content);\n\n    // --- Floating icon button (only shown when collapsed)\n    const iconBtn = document.createElement('a');\n    iconBtn.href = '#';\n    iconBtn.innerHTML = 'â“';\n    iconBtn.title = 'Show legend';\n    iconBtn.style.display = 'none';\n    iconBtn.style.textDecoration = 'none';\n    iconBtn.style.fontSize = '20px';\n    iconBtn.style.width = '36px';\n    iconBtn.style.height = '36px';\n    iconBtn.style.textAlign = 'center';\n    iconBtn.style.lineHeight = '36px';\n    iconBtn.style.borderRadius = '6px';\n    iconBtn.style.background = 'white';\n    iconBtn.style.boxShadow = '0 2px 6px rgba(0,0,0,0.2)';\n    iconBtn.style.cursor = 'pointer';\n\n    iconBtn.onclick = e => {\n      e.preventDefault();\n      isVisible = true;\n      updateVisibility();\n    };\n\n    function updateVisibility() {\n      panel.style.display = isVisible ? 'flex' : 'none';\n      iconBtn.style.display = isVisible ? 'none' : 'inline-block';\n    }\n\n    updateVisibility();\n\n    container.appendChild(panel);\n    container.appendChild(iconBtn);\n\n    return container;\n  };\n\n  legend.addTo(map);\n}\n","import { isDev } from './config.js';\n\nimport { baseLayers, satelliteLayers } from './layers';\n\nfunction showToast(message, duration = 2000) {\n  const toast = document.createElement('div');\n  toast.innerText = message;\n  toast.style.position = 'fixed';\n  toast.style.bottom = '50px';\n  toast.style.left = '50%';\n  toast.style.transform = 'translateX(-50%)';\n  toast.style.background = 'rgba(0,0,0,0.8)';\n  toast.style.color = '#fff';\n  toast.style.padding = '8px 12px';\n  toast.style.borderRadius = '6px';\n  toast.style.fontSize = '14px';\n  toast.style.zIndex = 9999;\n  toast.style.opacity = 0;\n  toast.style.transition = 'opacity 0.3s ease';\n\n  document.body.appendChild(toast);\n\n  // fade in\n  requestAnimationFrame(() => {\n    toast.style.opacity = 1;\n  });\n\n  setTimeout(() => {\n    toast.style.opacity = 0;\n    setTimeout(() => {\n      document.body.removeChild(toast);\n    }, 300);\n  }, duration);\n}\n\nexport function addContextMenu(map, goToCoords) {\n  const contextMenu = document.getElementById('context-menu');\n\n  function addMenuItem(label, action) {\n    const item = document.createElement('div');\n    item.innerText = label;\n    item.style.padding = '4px 8px';\n    item.style.cursor = 'pointer';\n    item.onmouseenter = () => (item.style.background = '#eee');\n    item.onmouseleave = () => (item.style.background = '');\n    item.onmousedown = () => {\n      action();\n      contextMenu.style.display = 'none';\n    };\n    contextMenu.appendChild(item);\n  }\n\n  function addSeparator() {\n    const hr = document.createElement('hr');\n    hr.style.margin = '0';\n    contextMenu.appendChild(hr);\n  }\n\n  map.on('contextmenu', function (e) {\n    const lat = e.latlng.lat.toFixed(6);\n    const lng = e.latlng.lng.toFixed(6);\n    const z = map.getZoom();\n    const currentBaseLayer = Object.values(baseLayers).find(v => map.hasLayer(v));\n    const currentSatelliteLayer = Object.values(satelliteLayers).find(v => map.hasLayer(v));\n    contextMenu.innerHTML = '';\n\n    addMenuItem('Edit in OpenStreetMap', () => {\n      window.open(\n        `https://www.openstreetmap.org/id?#map=${Math.max(16, map.getZoom())}/${lat}/${lng}`\n      );\n    });\n\n    if (isDev) {\n      addMenuItem('Edit Traces in OpenStreetMap', () => {\n        window.open(\n          `https://www.openstreetmap.org/id?#map=${Math.max(\n            16,\n            map.getZoom()\n          )}/${lat}/${lng}&background=Bing&overlays=osm-gps,strava-heatmap-all&disable_features=address_points,points,buildings,building_parts,indoor,landuse,boundaries,water,rail,pistes,aerialways,power,past_future,others`\n        );\n      });\n    }\n\n    addSeparator();\n\n    addMenuItem('Open in Google Maps', () => {\n      const params = new URLSearchParams({\n        api: 1,\n        map_action: 'map',\n        basemap: 'terrain',\n        center: [lat, lng].join(','),\n        zoom: z,\n      });\n      window.open(`https://www.google.com/maps/@?${unescape(params)}`);\n    });\n\n    if (isDev) {\n      addMenuItem('Open in Google Street View', () => {\n        window.open(`https://www.google.com/maps?q=&layer=c&cbll=${lat},${lng}`);\n      });\n\n      addMenuItem('Open in Mapillary', () => {\n        const params = new URLSearchParams({ lat, lng, z });\n        window.open(`https://www.mapillary.com/app/?${unescape(params)}`);\n      });\n    }\n\n    addMenuItem('Open in Komoot', () => {\n      window.open(`https://www.komoot.com/plan/@${lat},${lng},${z}z?sport=mtb`);\n    });\n\n    addSeparator();\n\n    addMenuItem('Search here', () => {\n      goToCoords(`${lat}, ${lng}`);\n    });\n\n    addMenuItem('Copy Coordinates', () => {\n      navigator.clipboard.writeText(`${lat}, ${lng}`).then(() => {\n        showToast('Coordinates copied to clipboard.');\n      });\n    });\n\n    addMenuItem('Get Elevation', () => {\n      fetch(`https://api.open-elevation.com/api/v1/lookup?locations=${lat},${lng}`)\n        .then(response => response.json())\n        .then(data => {\n          if (data.results && data.results.length > 0) {\n            const elevation = data.results[0].elevation;\n            showToast(`Elevation: ${elevation} meters`);\n          }\n        })\n        .catch(error => console.error('Error fetching elevation:', error));\n    });\n\n    if (isDev) {\n      addSeparator();\n\n      addMenuItem('Download OSM GPS traces', () => {\n        window.open(\n          'https://api.openstreetmap.org/api/0.6/trackpoints?bbox=' +\n            [\n              map.getBounds().getWest(),\n              map.getBounds().getSouth(),\n              map.getBounds().getEast(),\n              map.getBounds().getNorth(),\n            ].join(',') +\n            '&page=0'\n        );\n      });\n\n      addMenuItem('Generate SqliteDB', () => {\n        const bounds = map.getBounds();\n        const north = bounds.getNorth().toFixed(6);\n        const west = bounds.getWest().toFixed(6);\n        const south = bounds.getSouth().toFixed(6);\n        const east = bounds.getEast().toFixed(6);\n        const bboxString = `${north},${west},${south},${east}`;\n\n        let copyString;\n        if (currentSatelliteLayer?.options.opacity > 0) {\n          copyString = `node scripts/sqlitedb.js ./tmp/${\n            currentSatelliteLayer.options.id\n          }.sqlitedb '${currentSatelliteLayer._url.replace(\n            '{s}',\n            currentSatelliteLayer.options.subdomains[0]\n          )}' ${bboxString}`;\n        } else if (currentBaseLayer) {\n          copyString = `node scripts/sqlitedb.js ./tmp/${\n            currentBaseLayer.options.id\n          }.sqlitedb '${currentBaseLayer._url.replace(\n            '{s}',\n            currentBaseLayer.options.subdomains[0]\n          )}' ${bboxString}`;\n        }\n        if (copyString) {\n          navigator.clipboard.writeText(copyString).then(() => {\n            showToast('Command copied to clipboard.');\n          });\n        }\n      });\n    }\n\n    // Position and show menu\n    contextMenu.style.left = e.originalEvent.pageX + 'px';\n    contextMenu.style.top = e.originalEvent.pageY + 'px';\n    contextMenu.style.display = 'block';\n  });\n\n  const hideMenu = () => (contextMenu.style.display = 'none');\n\n  map.on('mousedown', hideMenu);\n  document.addEventListener('mousedown', hideMenu);\n}\n","import { regionBounds } from './config.js';\nimport { overlays } from './layers.js';\nimport { speeds as speedsColors, colors } from './config.js';\n\nexport function enableGpxDragAndDrop(map, layersControl, loadDrawingFromGpx) {\n  const mapContainer = map.getContainer();\n  const bounds = L.latLngBounds(regionBounds);\n\n  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n    mapContainer.addEventListener(eventName, e => e.preventDefault(), false);\n  });\n\n  mapContainer.addEventListener('drop', e => {\n    e.preventDefault();\n    if (!e.dataTransfer.files.length) return;\n\n    for (const file of e.dataTransfer.files) {\n      if (!file.name.toLowerCase().endsWith('.gpx')) continue;\n\n      const reader = new FileReader();\n      reader.onload = event => {\n        const gpxText = event.target.result;\n        if (loadDrawingFromGpx(gpxText)) {\n          return;\n        }\n\n        // Remove previous uploaded GPX layers\n        for (const overlayName in overlays) {\n          if (overlays.hasOwnProperty(overlayName) && overlays[overlayName] instanceof L.GeoJSON) {\n            layersControl.removeLayer(overlays[overlayName]);\n            map.removeLayer(overlays[overlayName]);\n            delete overlays[overlayName];\n          }\n        }\n\n        const geojson = loadFromGpx(gpxText);\n        if (geojson) {\n          // Create GeoJSON layer with custom styles\n          const layer = L.geoJSON(geojson, {\n            style: feature => ({\n              color: feature.properties.stroke,\n              opacity: feature.properties['stroke-opacity'],\n              weight: feature.properties['stroke-width'],\n            }),\n            onEachFeature: function (f, layer) {\n              layer.bindTooltip(\n                `<b>Speed:</b> ${f.properties.speed} km/h<br><b>Time:</b> ${f.properties.time}`\n              );\n            },\n          }).addTo(map);\n\n          // Add slider control for speed divider\n          addSpeedDividerSlider(map, layer);\n\n          const gpxBounds = layer.getBounds();\n          if (bounds.intersects(gpxBounds)) {\n            map.fitBounds(gpxBounds);\n            // Add to overlays and control\n            const name = file.name.replace(/\\.gpx$/i, '');\n            overlays[name] = layer;\n            layersControl.addOverlay(layer, name);\n          } else {\n            alert(\n              `GPX file \"${file.name}\" is outside the allowed bounds and will not be displayed.`\n            );\n          }\n          return;\n        }\n      };\n      reader.readAsText(file);\n    }\n  });\n\n  function loadFromGpx(gpxString) {\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(gpxString, 'text/xml');\n\n    const parserError = xmlDoc.querySelector('parsererror');\n    if (parserError) {\n      console.warn('Invalid GPX string:', parserError.textContent);\n      return null;\n    }\n\n    function haversineDistance(lat1, lon1, lat2, lon2) {\n      const R = 6371;\n      const dLat = ((lat2 - lat1) * Math.PI) / 180;\n      const dLon = ((lon2 - lon1) * Math.PI) / 180;\n      const a =\n        Math.sin(dLat / 2) ** 2 +\n        Math.cos((lat1 * Math.PI) / 180) *\n          Math.cos((lat2 * Math.PI) / 180) *\n          Math.sin(dLon / 2) ** 2;\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n      return R * c;\n    }\n\n    const geojson = {\n      type: 'FeatureCollection',\n      features: [],\n    };\n\n    let trackSegments = xmlDoc.querySelectorAll('trkseg');\n    if (!trackSegments.length) trackSegments = xmlDoc.querySelectorAll('rte');\n    trackSegments.forEach(segment => {\n      let trackPoints = segment.querySelectorAll('trkpt');\n      if (!trackPoints.length) trackPoints = xmlDoc.querySelectorAll('rtept');\n\n      for (let i = 1; i < trackPoints.length; i++) {\n        const prevPoint = trackPoints[i - 1];\n        const currPoint = trackPoints[i];\n\n        const lat1 = parseFloat(prevPoint.getAttribute('lat'));\n        const lon1 = parseFloat(prevPoint.getAttribute('lon'));\n        const lat2 = parseFloat(currPoint.getAttribute('lat'));\n        const lon2 = parseFloat(currPoint.getAttribute('lon'));\n        if ([lat1, lon1, lat2, lon2].some(isNaN)) continue;\n\n        let speedKmh = null;\n        const time1 = prevPoint.querySelector('time');\n        const time2 = currPoint.querySelector('time');\n        if (time1 && time2) {\n          try {\n            const t1 = new Date(time1.textContent);\n            const t2 = new Date(time2.textContent);\n            const timeDiffHours = (t2 - t1) / (1000 * 3600);\n            if (timeDiffHours > 0) {\n              const distanceKm = haversineDistance(lat1, lon1, lat2, lon2);\n              speedKmh = distanceKm / timeDiffHours;\n            }\n          } catch (e) {\n            speedKmh = null;\n          }\n        }\n\n        const colorConfig =\n          speedKmh === null\n            ? { color: colors.likely }\n            : speedsColors.find(config => speedKmh <= config.max) ||\n              speedsColors[speedsColors.length - 1];\n        const color = colorConfig.color;\n\n        const coords = [\n          [lon1, lat1],\n          [lon2, lat2],\n        ];\n\n        geojson.features.push({\n          type: 'Feature',\n          geometry: {\n            type: 'LineString',\n            coordinates: coords,\n          },\n          properties: {\n            baseSpeed: speedKmh ?? null,\n            speed: speedKmh ? speedKmh.toFixed(2) : null,\n            time: time1 ? time1.textContent : null,\n            stroke: color,\n            'stroke-opacity': 0.8,\n            'stroke-width': 7,\n          },\n        });\n      }\n    });\n\n    return geojson.features.length > 0 ? geojson : null;\n  }\n\n  function addSpeedDividerSlider(map, layer) {\n    // Prevent adding multiple sliders\n    if (document.getElementById('speed-multiplier')) return;\n\n    const slider = L.control({ position: 'topright' });\n\n    slider.onAdd = function (map) {\n      const div = L.DomUtil.create('div', 'leaflet-bar');\n      div.style.background = 'white';\n      div.style.padding = '6px 10px';\n      div.style.fontSize = '14px';\n      div.style.lineHeight = '1.2';\n      div.style.minWidth = '160px';\n\n      div.innerHTML = `\n        <label>\n          Speed Ã· <span id=\"multiplier-val\">1.00</span><br/>\n          <input id=\"speed-multiplier\" type=\"range\" min=\"0.1\" max=\"2\" step=\"0.01\" value=\"1\" style=\"width: 140px;\" />\n        </label>\n      `;\n\n      L.DomEvent.disableClickPropagation(div);\n      return div;\n    };\n\n    slider.addTo(map);\n\n    const sliderInput = document.getElementById('speed-multiplier');\n    const multiplierVal = document.getElementById('multiplier-val');\n\n    sliderInput.addEventListener('input', e => {\n      const divider = parseFloat(e.target.value);\n      multiplierVal.textContent = divider.toFixed(2);\n\n      layer.eachLayer(segment => {\n        const baseSpeed = segment.feature.properties.baseSpeed;\n        if (baseSpeed == null) return;\n\n        const newSpeed = baseSpeed / divider;\n        segment.feature.properties.speed = newSpeed.toFixed(2);\n\n        const colorConfig =\n          speedsColors.find(cfg => newSpeed <= cfg.max) || speedsColors[speedsColors.length - 1];\n        const color = colorConfig.color;\n\n        segment.setStyle({ color });\n\n        segment.setTooltipContent(\n          `<b>Speed:</b> ${newSpeed.toFixed(2)} km/h<br><b>Time:</b> ${\n            segment.feature.properties.time\n          }`\n        );\n      });\n    });\n  }\n}\n","import { isDev } from './config.js';\nimport { mainOverlay, mainOverlayAlt, stravaHeatmap } from './layers.js';\n\nexport function addKeyboardShortcuts(map) {\n  const svgPane = document.querySelector('.leaflet-overlay-pane');\n  function reverseOverlays() {\n    const el = document.getElementById('map');\n    if (mainOverlay.options.opacity === 1) {\n      mainOverlay.setOpacity(0);\n      svgPane.style.opacity = 0;\n      el.classList.remove('hide-overlays');\n    } else {\n      mainOverlay.setOpacity(1);\n      svgPane.style.opacity = 1;\n      // el.classList.add('hide-overlays');\n    }\n  }\n  function toggleOverlays(all = false) {\n    const el = document.getElementById('map');\n    if (el.classList.contains('hide-overlays')) {\n      // If overlays are hidden, show them\n      el.classList.remove('hide-overlays');\n      mainOverlay.setOpacity(1);\n    } else {\n      el.classList.toggle('hide-overlays'); // toggles the 'hidden' class on/off\n      mainOverlay.setOpacity(all ? 0 : 1);\n    }\n  }\n\n  function toggleSatellite() {\n    const slider = document.querySelector('.transparency-slider');\n    if (!slider) return;\n\n    const current = parseInt(slider.value, 10);\n    slider.value = current === 100 ? '0' : '100';\n\n    // Trigger the input event so it behaves reactively\n    slider.dispatchEvent(new Event('input', { bubbles: true }));\n  }\n\n  function toggleMainOverlay() {\n    if (!isDev) return;\n\n    if (map.hasLayer(mainOverlay)) {\n      map.removeLayer(mainOverlay);\n      map.addLayer(mainOverlayAlt);\n    } else if (map.hasLayer(mainOverlayAlt)) {\n      map.removeLayer(mainOverlayAlt);\n      map.addLayer(mainOverlay);\n    }\n  }\n\n  function toggleStravaOverlay() {\n    if (!isDev) return;\n\n    if (map.hasLayer(stravaHeatmap)) {\n      map.removeLayer(stravaHeatmap);\n    } else {\n      map.addLayer(stravaHeatmap);\n    }\n  }\n\n  document.addEventListener('keydown', e => {\n    const active = document.activeElement;\n    if (\n      active &&\n      (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA' || active.isContentEditable)\n    )\n      return;\n\n    if (e.key.toLowerCase() === 'a') {\n      toggleOverlays(true);\n    } else if (e.key.toLowerCase() === 'q') {\n      toggleOverlays(false);\n    } else if (e.key.toLowerCase() === 'w') {\n      reverseOverlays();\n    } else if (e.key.toLowerCase() === 's') {\n      toggleSatellite();\n    } else if (e.key === 'Delete') {\n      localStorage.clear();\n      location.reload();\n    } else if (e.key.toLowerCase() === 'e') {\n      toggleMainOverlay();\n    } else if (e.key.toLowerCase() === 'x') {\n      toggleStravaOverlay();\n    }\n  });\n}\n","export const drawnLines = [];\n\nexport function addHighlightPen(map) {\n  let currentLine = null;\n  let drawing = false;\n  let isActivelyDrawing = false;\n  let downloadBtn = null;\n\n  const polylineOptions = map => {\n    const zoom = map.getZoom();\n    const baseWeight = 25;\n    const scaledWeight = Math.max(4, baseWeight - (18 - zoom) * 2);\n    return {\n      color: 'yellow',\n      weight: scaledWeight,\n      opacity: 0.3,\n    };\n  };\n\n  const controls = L.control({ position: 'bottomleft' });\n\n  controls.onAdd = function () {\n    const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control');\n\n    const drawBtn = L.DomUtil.create('a', '', container);\n    drawBtn.href = '#';\n    drawBtn.innerHTML = 'ðŸ–Šï¸';\n    drawBtn.title = 'Toggle highlighter';\n    drawBtn.style.padding = '6px 10px';\n    drawBtn.style.fontSize = '20px';\n\n    const clearBtn = L.DomUtil.create('a', '', container);\n    clearBtn.href = '#';\n    clearBtn.innerHTML = 'ðŸ§½';\n    clearBtn.title = 'Clear highlights';\n    clearBtn.style.padding = '6px 10px';\n    clearBtn.style.fontSize = '20px';\n\n    downloadBtn = L.DomUtil.create('a', '', container);\n    downloadBtn.href = '#';\n    downloadBtn.innerHTML = 'â¬‡ï¸';\n    downloadBtn.title = 'Download GPX';\n    downloadBtn.style.padding = '6px 10px';\n    downloadBtn.style.fontSize = '20px';\n    downloadBtn.classList.add('leaflet-disabled');\n    downloadBtn.style.opacity = '0.3';\n    downloadBtn.style.pointerEvents = 'none';\n\n    drawBtn.onclick = e => {\n      e.preventDefault();\n      drawing = !drawing;\n      if (!drawing) {\n        currentLine = null; // Reset currentLine only when drawing mode is toggled off\n        isActivelyDrawing = false;\n      }\n      updateDrawButton();\n      if (!drawing) {\n        enableMapInteractions();\n      }\n    };\n\n    clearBtn.onclick = e => {\n      e.preventDefault();\n      drawnLines.forEach(line => map.removeLayer(line));\n      drawnLines.length = 0;\n      currentLine = null;\n      isActivelyDrawing = false;\n      updateDownloadButtonState();\n    };\n\n    downloadBtn.onclick = e => {\n      e.preventDefault();\n      if (!downloadBtn.classList.contains('leaflet-disabled')) {\n        downloadAsGpx();\n      }\n    };\n\n    L.DomEvent.disableClickPropagation(container);\n    L.DomEvent.disableScrollPropagation(container);\n\n    function updateDrawButton() {\n      if (drawing) {\n        drawBtn.style.background = '#ff0';\n        drawBtn.style.color = 'black';\n      } else {\n        drawBtn.style.background = 'white';\n        drawBtn.style.color = '';\n      }\n    }\n\n    return container;\n  };\n\n  controls.addTo(map);\n\n  function disableMapInteractions() {\n    map.dragging.disable();\n    map.doubleClickZoom.disable();\n    map.boxZoom.disable();\n    map.scrollWheelZoom.disable();\n  }\n\n  function enableMapInteractions() {\n    map.dragging.enable();\n    map.doubleClickZoom.enable();\n    map.boxZoom.enable();\n    map.scrollWheelZoom.enable();\n  }\n\n  function getLatLngFromEvent(e) {\n    if (e.latlng) return e.latlng;\n    if (e.touches && e.touches.length > 0) {\n      return map.containerPointToLatLng(map.mouseEventToContainerPoint(e.touches[0]));\n    }\n    return null;\n  }\n\n  function startDrawing(e) {\n    if (!drawing) return;\n    const latlng = getLatLngFromEvent(e);\n    if (!latlng) return;\n\n    if (!isActivelyDrawing) {\n      isActivelyDrawing = true;\n      disableMapInteractions();\n      if (!currentLine) {\n        currentLine = L.polyline([latlng], polylineOptions(map)).addTo(map);\n        drawnLines.push(currentLine);\n      } else {\n        currentLine.addLatLng(latlng);\n      }\n    }\n\n    if (e.preventDefault) e.preventDefault();\n  }\n\n  function continueDrawing(e) {\n    if (!drawing || !isActivelyDrawing || !currentLine) return;\n    const latlng = getLatLngFromEvent(e);\n    if (!latlng) return;\n    currentLine.addLatLng(latlng);\n    if (e.preventDefault) e.preventDefault();\n  }\n\n  function endDrawing(e) {\n    if (drawing && isActivelyDrawing) {\n      isActivelyDrawing = false;\n      updateDownloadButtonState();\n      enableMapInteractions();\n    }\n    if (e.preventDefault) e.preventDefault();\n  }\n\n  // Mouse events\n  map.on('mousedown', startDrawing);\n  map.on('mousemove', continueDrawing);\n  map.on('mouseup', endDrawing);\n\n  // Touch events\n  const mapContainer = map.getContainer();\n  mapContainer.addEventListener('touchstart', startDrawing, { passive: true });\n  mapContainer.addEventListener('touchmove', continueDrawing, { passive: true });\n  mapContainer.addEventListener('touchend', endDrawing, { passive: true });\n\n  map.on('zoomend', () => {\n    drawnLines.forEach(line => line.setStyle(polylineOptions(map)));\n  });\n\n  window.addEventListener('keydown', e => {\n    if (e.key.toLowerCase() === 'd') {\n      drawing = !drawing;\n      if (!drawing) {\n        currentLine = null; // Reset currentLine when drawing mode is toggled off\n        isActivelyDrawing = false;\n      }\n      updateDrawButton();\n      if (!drawing) {\n        enableMapInteractions();\n      }\n    }\n\n    if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'z') {\n      if (drawnLines.length > 0) {\n        const lastLine = drawnLines.pop();\n        map.removeLayer(lastLine);\n        if (currentLine === lastLine) {\n          currentLine = null;\n          isActivelyDrawing = false;\n        }\n        saveToUrl();\n        updateDownloadButtonState();\n      }\n    }\n  });\n\n  function updateDrawButton() {\n    const drawBtn = document.querySelector('.leaflet-bar a[title=\"Toggle highlighter\"]');\n    if (!drawBtn) return;\n    if (drawing) {\n      drawBtn.style.background = '#ff0';\n      drawBtn.style.color = 'black';\n    } else {\n      drawBtn.style.background = 'white';\n      drawBtn.style.color = '';\n    }\n  }\n\n  function updateDownloadButtonState() {\n    if (!downloadBtn) return;\n    if (drawnLines.length) {\n      downloadBtn.classList.remove('leaflet-disabled');\n      downloadBtn.style.opacity = '1';\n      downloadBtn.style.pointerEvents = 'auto';\n    } else {\n      downloadBtn.classList.add('leaflet-disabled');\n      downloadBtn.style.opacity = '0.3';\n      downloadBtn.style.pointerEvents = 'none';\n    }\n  }\n\n  function loadFromUrl() {\n    const params = new URLSearchParams(window.location.search);\n    const raw = params.get('data');\n    if (!raw) return;\n\n    const segments = raw.split(';');\n    segments.forEach(encoded => {\n      try {\n        const coords = polyline.decode(encoded).map(([lat, lng]) => L.latLng(lat, lng));\n        const line = L.polyline(coords, polylineOptions(map)).addTo(map);\n        drawnLines.push(line);\n      } catch (e) {\n        console.warn('Invalid polyline segment:', encoded);\n      }\n    });\n\n    updateDownloadButtonState();\n  }\n\n  function loadDrawingFromGpx(gpxString) {\n    try {\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(gpxString, 'text/xml');\n\n      // Check for parsing errors\n      const parserError = xmlDoc.querySelector('parsererror');\n      if (parserError) {\n        console.warn('Invalid GPX string:', parserError.textContent);\n        return false;\n      }\n\n      // Verify creator attribute\n      const gpxElement = xmlDoc.querySelector('gpx');\n      if (!gpxElement || gpxElement.getAttribute('creator') !== 'MapDrawer') {\n        // console.warn('GPX file not created by MapDrawer or invalid GPX structure');\n        return false;\n      }\n\n      // Clear existing lines\n      drawnLines.forEach(line => map.removeLayer(line));\n      drawnLines.length = 0;\n      currentLine = null;\n      drawing = false;\n      // updateDrawButton();\n      // updateDownloadButtonState();\n\n      // Process track segments\n      const trackSegments = xmlDoc.querySelectorAll('trkseg');\n      trackSegments.forEach(segment => {\n        const coords = [];\n        const trackPoints = segment.querySelectorAll('trkpt');\n        trackPoints.forEach(point => {\n          const lat = parseFloat(point.getAttribute('lat'));\n          const lon = parseFloat(point.getAttribute('lon'));\n          if (!isNaN(lat) && !isNaN(lon)) {\n            coords.push(L.latLng(lat, lon));\n          }\n        });\n        if (coords.length > 0) {\n          const line = L.polyline(coords, polylineOptions(map)).addTo(map);\n          drawnLines.push(line);\n        }\n      });\n\n      if (drawnLines.length > 0) {\n        const allCoords = drawnLines.flatMap(line => line.getLatLngs());\n        map.fitBounds(L.latLngBounds(allCoords));\n      }\n\n      // Update download button state\n      updateDownloadButtonState();\n\n      return true;\n    } catch (e) {\n      console.warn('Error parsing GPX string:', e);\n    }\n\n    return false;\n  }\n\n  function downloadAsGpx() {\n    if (!drawnLines.length) return;\n\n    // Get current UTC timestamp\n    const now = new Date();\n    const timestamp = now.toISOString(); // e.g., 2025-07-17T11:04:00.000Z\n\n    const gpxHeader = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<gpx version=\"1.1\" creator=\"MapDrawer\" xmlns=\"http://www.topografix.com/GPX/1/1\">\n  <trk>\n    <name>Manually Drawn Trace</name>\n    <desc>Manually drawn trace for mapping purposes, not GPS-accurate.</desc>`;\n\n    const gpxFooter = `</trk></gpx>`;\n\n    const segments = drawnLines\n      .map(line => {\n        const pts = line\n          .getLatLngs()\n          .map(\n            p =>\n              `<trkpt lat=\"${p.lat.toFixed(6)}\" lon=\"${p.lng.toFixed(\n                6\n              )}\"><time>${timestamp}</time></trkpt>`\n          )\n          .join('\\n');\n        return `<trkseg>\\n${pts}\\n</trkseg>`;\n      })\n      .join('\\n');\n\n    const gpx = `${gpxHeader}\\n${segments}\\n${gpxFooter}`;\n    const blob = new Blob([gpx], { type: 'application/gpx+xml' });\n    const url = URL.createObjectURL(blob);\n\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'drawing.gpx';\n    a.click();\n\n    URL.revokeObjectURL(url);\n  }\n\n  return { loadDrawingFromGpx };\n}\n","export function addSearchControl(map) {\n  const container = L.DomUtil.create('div', 'leaflet-bottom-center leaflet-bar leaflet-control');\n  container.style.backgroundColor = 'white';\n  container.style.padding = '4px';\n  container.style.borderRadius = '4px';\n  container.style.minWidth = '250px';\n  container.style.display = 'flex';\n  container.style.gap = '4px';\n  container.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)';\n  container.style.alignItems = 'center';\n\n  const input = L.DomUtil.create('input', '', container);\n  input.type = 'text';\n  input.placeholder = 'Enter lat, lon';\n  input.style.flex = '1';\n  input.style.border = 'none';\n  input.style.outline = 'none';\n  input.style.padding = '4px';\n\n  const goButton = L.DomUtil.create('button', '', container);\n  goButton.textContent = 'Go';\n  goButton.style.cursor = 'pointer';\n  goButton.style.padding = '4px 8px';\n  goButton.disabled = true;\n\n  const closeButton = L.DomUtil.create('button', '', container);\n  closeButton.textContent = 'Ã—';\n  closeButton.style.cursor = 'pointer';\n  closeButton.style.padding = '4px 8px';\n  closeButton.style.display = 'none';\n\n  const CoordControl = L.Control.extend({\n    onAdd: function () {\n      return container;\n    },\n    onRemove: function () {},\n  });\n\n  const control = new CoordControl({ position: 'bottomleft' });\n  control.addTo(map);\n\n  L.DomEvent.disableClickPropagation(container);\n  L.DomEvent.disableScrollPropagation(container);\n\n  let marker;\n\n  function updateURL(lat, lon) {\n    const url = new URL(window.location.href);\n    url.searchParams.set('coord', `${lat},${lon}`);\n    url.hash = window.location.hash; // preserve hash\n    window.history.replaceState({}, '', url);\n  }\n\n  function removeCoordFromURL() {\n    const url = new URL(window.location.href);\n    url.searchParams.delete('coord');\n    url.hash = window.location.hash; // preserve hash\n    window.history.replaceState({}, '', url);\n  }\n\n  function goToCoords(val) {\n    input.value = coordParam;\n    goButton.disabled = false;\n\n    const parts = val.split(',').map(s => s.trim());\n    if (parts.length !== 2) {\n      alert('Please enter coordinates as \"lat, lon\"');\n      return;\n    }\n\n    const lat = parseFloat(parts[0]);\n    const lon = parseFloat(parts[1]);\n\n    if (isNaN(lat) || isNaN(lon)) {\n      alert('Invalid latitude or longitude');\n      return;\n    }\n\n    if (lat < -90 || lat > 90 || lon < -180 || lon > 180) {\n      alert('Coordinates out of range');\n      return;\n    }\n\n    const latlng = [lat, lon];\n    map.setView(latlng, 15);\n\n    if (marker) {\n      marker.setLatLng(latlng);\n    } else {\n      marker = L.marker(latlng).addTo(map);\n    }\n\n    updateURL(lat, lon);\n    closeButton.style.display = '';\n  }\n\n  function clearSearch() {\n    input.value = '';\n    goButton.disabled = true;\n    closeButton.style.display = 'none';\n    if (marker) {\n      map.removeLayer(marker);\n      marker = null;\n    }\n    removeCoordFromURL();\n  }\n\n  goButton.addEventListener('click', () => goToCoords(input.value));\n  closeButton.addEventListener('click', clearSearch);\n\n  input.addEventListener('input', () => {\n    const isValid = /^\\s*-?\\d+(\\.\\d+)?\\s*,\\s*-?\\d+(\\.\\d+)?\\s*$/.test(input.value.trim());\n    goButton.disabled = !isValid;\n  });\n\n  input.addEventListener('keydown', e => {\n    if (e.key === 'Enter' && !goButton.disabled) {\n      goToCoords(input.value);\n    }\n  });\n\n  // On load\n  const urlParams = new URLSearchParams(window.location.search);\n  const coordParam = urlParams.get('coord');\n  if (coordParam) {\n    goToCoords(coordParam);\n  }\n\n  container.appendChild(closeButton);\n\n  return { goToCoords };\n}\n","import { isDev } from './config.js';\nimport { promptPassword } from './auth.js';\nimport { initializeMap } from './mapSetup.js';\nimport { addLegend } from './legend.js';\nimport { addContextMenu } from './contextMenu.js';\nimport { enableGpxDragAndDrop } from './gpxDragDrop.js';\nimport { addKeyboardShortcuts } from './keyboard.js';\nimport { addHighlightPen } from './draw.js';\nimport { addBaseLayerTransparencyControl } from './transparency.js';\nimport { addSearchControl } from './search.js';\n\nimport '../css/index.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  if (isDev) {\n    document.title = 'ðŸ¤–' + document.title;\n  }\n\n  const { map, layersControl } = initializeMap();\n\n  addLegend(map);\n\n  addKeyboardShortcuts(map);\n  const { goToCoords } = addSearchControl(map);\n  const { loadDrawingFromGpx } = addHighlightPen(map);\n  addContextMenu(map, goToCoords);\n\n  enableGpxDragAndDrop(map, layersControl, loadDrawingFromGpx);\n  addBaseLayerTransparencyControl(map);\n\n  window.addEventListener('load', promptPassword);\n  document.addEventListener('visibilitychange', () => {\n    if (document.visibilityState === 'visible') promptPassword();\n  });\n});\n"],"names":["isDev","clipBounds","regionBounds","colors","speeds","timestamp","minZoom","maxZoom","PASSWORD","STORAGE_KEY_AUTH","ONE_MONTH_MS","isPasswordValid","stored","password","expires","storePassword","promptPassword","mainOverlay","mainOverlayAlt","createDRRLayer","attribution","layers","DRR_DYNAMIC_LAYERS","GOOGLE_LAYERS","googleSatellite","googleMaps","googleTerrain","googleHybrid","esriFirefly","esriClarity","esriWayback","thunderforestTransport","thunderforestCycle","osmStandard","worldTopoMap","rtsMap","slopeTiles","googleStreetViewTiles","mapillaryVector","kartaViewTiles","stravaHeatmap","osmGpsTraces","baseLayers","satelliteLayers","overlays","baseLayerTransparency","addBaseLayerTransparencyControl","map","baseControl","div","select","label","option","savedName","defaultName","currentSatelliteLayer","input","e","selectedName","STORAGE_KEY_VIEW","STORAGE_KEY_BASE","STORAGE_KEY_SATELLITE","STORAGE_KEY_OVERLAYS","initializeMap","createMap","setInitialView","layersControl","restoreLayerSelection","setupEventListeners","hashMatch","zoom","lat","lng","saved","center","currentBaseLayer","baseName","overlayJSON","savedOverlays","name","layer","satName","selectedBaseLayer","_","v","selectedSatLayer","activeOverlays","hash","addLegend","legend","container","isVisible","colorBox","color","panel","header","title","collapseBtn","updateVisibility","content","iconBtn","showToast","message","duration","toast","addContextMenu","goToCoords","contextMenu","addMenuItem","action","item","addSeparator","hr","z","params","response","data","elevation","error","bounds","north","west","south","east","bboxString","copyString","hideMenu","enableGpxDragAndDrop","loadDrawingFromGpx","mapContainer","eventName","file","reader","event","gpxText","overlayName","geojson","loadFromGpx","feature","f","addSpeedDividerSlider","gpxBounds","gpxString","xmlDoc","parserError","haversineDistance","lat1","lon1","lat2","lon2","dLat","dLon","a","trackSegments","segment","trackPoints","i","prevPoint","currPoint","speedKmh","time1","time2","t1","timeDiffHours","speedsColors","config","coords","slider","sliderInput","multiplierVal","divider","baseSpeed","newSpeed","cfg","addKeyboardShortcuts","svgPane","reverseOverlays","el","toggleOverlays","all","toggleSatellite","current","toggleMainOverlay","toggleStravaOverlay","active","drawnLines","addHighlightPen","currentLine","drawing","isActivelyDrawing","downloadBtn","polylineOptions","controls","drawBtn","clearBtn","updateDrawButton","enableMapInteractions","line","updateDownloadButtonState","downloadAsGpx","disableMapInteractions","getLatLngFromEvent","startDrawing","latlng","continueDrawing","endDrawing","lastLine","gpxElement","point","lon","allCoords","gpxHeader","gpxFooter","segments","p","gpx","blob","url","addSearchControl","goButton","closeButton","CoordControl","marker","updateURL","removeCoordFromURL","val","coordParam","parts","s","clearSearch","isValid"],"mappings":"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"}